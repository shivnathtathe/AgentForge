<!-- <div class="chat-container">
  <h2>ğŸ’¬ Agent Task Executor</h2>

  <textarea
    class="task-input"
    [(ngModel)]="task"
    placeholder="Enter your task..."
    rows="3"
  ></textarea>

  <div *ngIf="toolParams.length" class="param-section">
    <div *ngFor="let param of toolParams" class="param-input">
      <label>{{ param.name }} ({{ param.type }})</label>
      <input [(ngModel)]="args[param.name]" />
    </div>
  </div>

  <button class="run-button" (click)="executeTask()" [disabled]="!task.trim() || loading">
  {{ loading ? 'Running...' : 'ğŸš€ Execute Task' }}
</button>


  <div *ngIf="result" class="result-box">
    <h3>Result</h3>
    <pre>{{ result }}</pre>
  </div>
</div> -->

<!-- 
<div class="chat-container">
  <h2>ğŸ’¬ AgentForge Assistant</h2>

  <div class="chat-thread">
    <div *ngFor="let message of chatHistory" [ngClass]="{'user-msg': message.sender === 'user', 'agent-msg': message.sender === 'agent'}">
      <strong>{{ message.sender === 'user' ? 'ğŸ§‘ You' : 'ğŸ¤– Agent' }}</strong>: {{ message.text }}
    </div>
  </div>

  <textarea
    class="task-input"
    [(ngModel)]="task"
    placeholder="Enter your task..."
    rows="3"
  ></textarea>

  <div *ngIf="toolParams.length" class="param-section">
    <div *ngFor="let param of toolParams" class="param-input">
      <label>{{ param.name }} ({{ param.type }})</label>
      <input [(ngModel)]="args[param.name]" />
    </div>
  </div>

  <button class="run-button" (click)="executeTask()" [disabled]="!task.trim() || loading">
    {{ loading ? 'Running...' : 'ğŸš€ Execute Task' }}
  </button>
</div> -->


<!-- chat-ui.component.html - Updated with wrapper -->
<div class="chat-wrapper">
  <div class="chat-container">
    <div class="chat-header">
      <h2>
        <span>ğŸ¤–</span>
        AgentForge Assistant
      </h2>
      <span class="status-indicator" [class.active]="!loading">
        <span class="dot"></span>
        {{ loading ? 'Thinking...' : 'Ready' }}
      </span>
    </div>

    <div class="chat-thread" #chatThread>
      <!-- Welcome Message - Show when no chat history -->
      <div *ngIf="chatHistory.length === 0" class="welcome-message">
        <h3>Welcome to AgentForge! ğŸš€</h3>
        <p>I can help you with any task by creating specialized AI tools on demand. Just tell me what you need!</p>
        
        <div class="example-tasks">
          <div *ngFor="let example of exampleTasks" 
               class="example-task" 
               (click)="sendQuickAction(example)">
            {{ example }}
          </div>
        </div>
      </div>

      <!-- Chat Messages -->
      <div *ngFor="let message of chatHistory" 
           class="message"
           [ngClass]="{
             'user-msg': message.sender === 'user',
             'agent-msg': message.sender === 'agent',
             'system-msg': message.sender === 'system',
             'error-msg': message.isError
           }">
        <div class="message-header">
          <span class="sender-icon">
            {{ message.sender === 'user' ? 'ğŸ‘¤' : message.sender === 'agent' ? 'ğŸ¤–' : 'âš™ï¸' }}
          </span>
          <span class="sender-name">
            {{ message.sender === 'user' ? 'You' : message.sender === 'agent' ? 'AgentForge' : 'System' }}
          </span>
          <span class="timestamp">
            {{ message.timestamp | date:'short' }}
          </span>
        </div>
        <div class="message-content" [innerHTML]="formatMessage(message.text)"></div>
      </div>

      <!-- Parameter Input Section -->
      <div *ngIf="waitingForParams" class="param-request-section">
        <div class="param-header">
          <span class="param-icon">ğŸ“‹</span>
          Please provide the following information:
        </div>
        
        <div class="param-inputs">
          <div *ngFor="let param of requiredParams" class="param-input-group">
            <label>{{ param.name | titlecase }}:</label>
            <input 
              [(ngModel)]="paramValues[param.name]" 
              [placeholder]="param.placeholder"
              [type]="getInputType(param.type)"
              class="param-input"
              (keyup.enter)="submitWithParameters()">
          </div>
        </div>

        <div class="param-actions">
          <button class="btn btn-primary" (click)="submitWithParameters()" [disabled]="!allParamsProvided()">
            âœ… Submit
          </button>
          <button class="btn btn-secondary" (click)="cancelParameters()">
            âŒ Cancel
          </button>
        </div>
      </div>

      <!-- Loading Animation -->
      <div *ngIf="loading" class="loading-indicator">
        <div class="typing-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <span class="loading-text">AgentForge is thinking...</span>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions" *ngIf="!waitingForParams && chatHistory.length > 0">
      <span class="quick-label">Quick actions:</span>
      <button *ngFor="let action of quickActions" 
              class="quick-btn" 
              (click)="sendQuickAction(action.task)"
              [title]="action.task">
        <span class="quick-icon">{{ action.icon }}</span>
        <span class="quick-text">{{ action.text }}</span>
      </button>
    </div>

    <!-- Input Area -->
    <div class="input-section">
      <textarea
        class="task-input"
        [(ngModel)]="task"
        placeholder="Ask me anything... I'll create the right tool for the job!"
        rows="2"
        (keydown)="handleKeyPress($event)"
        [disabled]="loading || waitingForParams"
      ></textarea>
      
      <button 
        class="send-button" 
        (click)="executeTask()" 
        [disabled]="!task.trim() || loading || waitingForParams"
        [class.loading]="loading">
        <span *ngIf="!loading">ğŸš€ Send</span>
        <span *ngIf="loading">â³ Processing...</span>
      </button>
    </div>
  </div>
</div>